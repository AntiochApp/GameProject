<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Pilgrimâ€™s Journey â€“ Game</title>

<style>
  body {
    margin: 0;
    padding: 0;
    font-family: "Georgia", serif;
    background: url('bg_game.png') center/cover fixed;
    color: #fff;
  }

  #topBar {
    background: rgba(0,0,0,0.55);
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  #faithPoints {
    font-size: 18px;
    font-weight: bold;
  }

  #mainBox {
    max-width: 800px;
    margin: 40px auto;
    background: rgba(0,0,0,0.55);
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  }

  #textKorean {
    font-size: 20px;
    margin-bottom: 20px;
    line-height: 1.5;
  }

  #textEnglish {
    font-size: 16px;
    opacity: 0.85;
    line-height: 1.5;
  }

  .choiceBtn {
    display: block;
    width: 100%;
    margin: 12px 0;
    padding: 14px;
    font-size: 16px;
    background: #8e5b32;
    border: none;
    border-radius: 8px;
    color: #fff;
    cursor: pointer;
  }
  .choiceBtn:hover {
    background: #6e4526;
  }

  #saveBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #ffcc44;
    padding: 14px 18px;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    color: #000;
  }
</style>
</head>

<body>

<!-- ìƒë‹¨ë°” -->
<div id="topBar">
  <div id="playerName">Player</div>
  <div id="faithPoints">ì‹ ì•™ í¬ì¸íŠ¸: 0</div>
</div>

<!-- ë©”ì¸ ìŠ¤í† ë¦¬ ë°•ìŠ¤ -->
<div id="mainBox">
  <div id="textKorean">ì—¬ê¸°ì— ìŠ¤í† ë¦¬ í•œêµ­ì–´ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
  <div id="textEnglish">Here the English translation will appear.</div>

  <button class="choiceBtn" onclick="nextEvent()">ë‹¤ìŒ ì§„í–‰</button>
</div>

<!-- ì €ì¥ ë²„íŠ¼ -->
<div id="saveBtn" onclick="saveGame()">ğŸ’¾ ì €ì¥</div>

<script>
  // ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ë„˜ê²¨ë°›ì€ ID ì €ì¥
  let playerId = localStorage.getItem("playerId") || "";
  let faith = 0;
  let stage = 1;

  const API_URL = "ğŸ‘‰ ë„ˆì˜ ì›¹ì•± URL ë„£ê¸° ğŸ‘ˆ";

  // ê²Œì„ ì‹œì‘ ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
  window.onload = () => {
    if (!playerId) {
      alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!");
      window.location.href = "index.html";
      return;
    }

    document.getElementById("playerName").innerText = "Player: " + playerId;
    loadGame();
  };

  // ì„œë²„ì—ì„œ ì €ì¥ëœ ì§„í–‰ë„ ë¶ˆëŸ¬ì˜¤ê¸°
  async function loadGame() {
    const res = await fetch(API_URL, {
      method: "POST",
      body: JSON.stringify({
        type: "login",
        id: playerId,
        password: "loadOnly"
      })
    });

    const text = await res.text();
    const data = JSON.parse(text);

    if (data.saveData) {
      let saved = JSON.parse(data.saveData);
      faith = saved.faith;
      stage = saved.stage;
    }

    updateUI();
    showEvent();
  }

  function updateUI() {
    document.getElementById("faithPoints").innerText = "ì‹ ì•™ í¬ì¸íŠ¸: " + faith;
  }

  function showEvent() {
    document.getElementById("textKorean").innerText =
      "ğŸš¶â€â™‚ï¸ í˜„ì¬ ìŠ¤í…Œì´ì§€: " + stage + "\nëœë¤ ì´ë²¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.";
    document.getElementById("textEnglish").innerText =
      "ğŸš¶â€â™‚ï¸ Current Stage: " + stage + "\nA random event will appear here.";
  }

  function nextEvent() {
    faith += Math.floor(Math.random() * 3) + 1; // +1~3 í¬ì¸íŠ¸ ì¦ê°€
    updateUI();
    showEvent();
  }

  // ì €ì¥ ë²„íŠ¼
  async function saveGame() {
    const data = {
      faith,
      stage
    };

    await fetch(API_URL, {
      method: "POST",
      body: JSON.stringify({
        type: "save",
        id: playerId,
        saveData: JSON.stringify(data)
      })
    });

    alert("ì €ì¥ ì™„ë£Œ!");
  }
</script>

</body>
</html>
